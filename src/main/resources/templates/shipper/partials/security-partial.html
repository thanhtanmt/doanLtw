<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Bảo mật & Đăng nhập</title>
    <link rel="stylesheet" th:href="@{/css/bootstrap.min.css}">
    <link rel="stylesheet" th:href="@{/css/shipper-style.css}">
    <style>body{background:transparent;padding:0;margin:0}</style>
</head>
<body>
<div class="content-box" style="box-shadow:none;border:none;padding:0;background:transparent">
    <h2 class="h5 mb-3">Bảo mật & Đăng nhập</h2>
    <div class="row g-3">
        <div class="col-md-4">
            <label class="form-label">Mật khẩu hiện tại</label>
            <input id="currentPassword" type="password" class="form-control" placeholder="••••••">
        </div>
        <div class="col-md-4">
            <label class="form-label">Mật khẩu mới</label>
            <input id="newPassword" type="password" class="form-control">
        </div>
        <div class="col-md-4">
            <label class="form-label">Xác nhận mật khẩu mới</label>
            <input id="confirmNewPassword" type="password" class="form-control">
        </div>
    </div>
    <div class="mt-3">
        <button id="changePasswordBtn" class="btn btn-warning"><i class="fas fa-key me-1"></i>Đổi mật khẩu</button>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', () => {
  document.getElementById('changePasswordBtn').addEventListener('click', async ()=>{
    const currentPassword = document.getElementById('currentPassword').value;
    const newPassword = document.getElementById('newPassword').value;
    const confirmNewPassword = document.getElementById('confirmNewPassword').value;
    if (newPassword !== confirmNewPassword) { alert('Mật khẩu xác nhận không khớp'); return; }
    const form = new URLSearchParams();
    form.append('currentPassword', currentPassword);
    form.append('newPassword', newPassword);
    const res = await fetch('/api/shipper/profile/change-password',{ method:'POST', headers:{'Content-Type':'application/x-www-form-urlencoded'}, body: form.toString() });
    const j = await res.json();
    alert(j.success? 'Đổi mật khẩu thành công' : (j.message||'Đổi mật khẩu thất bại'));
  });
});
</script>
</body>
</html>

